function Container(){this.id="",this.className="",this.htmlCode=""}function Basket(){Container.call(this),this.id="basket",this.countGoods=0,this.amount=0,this.basket_items=[],this.retreive()}Container.prototype.render=function(){return this.htmlCode},Basket.prototype=Object.create(Container.prototype),Basket.prototype.constructor=Basket,Basket.prototype.render=function(){var t=$("<div/>",{id:this.id+"_items"});$("#"+this.id).append(t)},Basket.prototype.retreive=function(){$.get({url:"basket/get/json.txt",context:this,success:function(t){if(1===t.result){this.countGoods=t.basket.length,this.basket_items=t.basket,this.amount=t.amount;var e=$("<div/>",{id:"basket_data"}),s=$("<div/>",{id:"basket_details"});$("#"+this.id).append(e),$("#"+this.id).append(s),this.refresh()}0===t.result&&alert(t.error_message)},dataType:"json"})},Basket.prototype.add=function(t,e){$.get({url:"basket/add/json.txt",context:this,success:function(s){if(1===s.result){var i;for(var a in s.items)if(s.items[a].id_product==t){i=s.items[a].price;break}this.countGoods+=e,this.amount+=i*e;for(var a in this.basket_items){if(this.basket_items[a].id_product==t){this.basket_items[a].quantity+=e;break}a==this.basket_items.length-1&&this.basket_items.push({id_product:t,price:i,quantity:e})}0==this.basket_items.length&&this.basket_items.push({id_product:t,price:i,quantity:e}),this.refresh()}0===s.result&&alert(s.error_message)},dataType:"json"})},Basket.prototype.delete=function(t,e){$.get({url:"basket/add/json.txt",context:this,success:function(s){if(1===s.result){for(var i in this.basket_items){if(this.basket_items[i].id_product==t){this.basket_items[i].quantity-=e,this.countGoods-=e,this.amount-=this.basket_items[i].price*e,0==this.basket_items[i].quantity&&this.basket_items.splice(i,1);break}i==this.basket_items.length-1&&alert("Такого товара нет в корзине")}0==this.basket_items.length&&alert("Корзина пуста"),this.refresh()}0===s.result&&alert(s.error_message)},dataType:"json"})},Basket.prototype.refresh=function(){var t=$("#basket_data"),e=$("#basket_details");t.empty(),e.empty(),t.text("Товаров в корзине на общую сумму - "+this.amount+" рублей");for(var s in this.basket_items){var i=$("<div/>",{id:"basket_item"});void 0==this.basket_items[s].quantity&&(this.basket_items[s].quantity=1),i.text("Товар с id "+this.basket_items[s].id_product+" по цене "+this.basket_items[s].price+" рублей в количестве "+this.basket_items[s].quantity),$("#basket_details").append(i)}},$(document).ready(function(){var t=new Basket;$("#buy1").on("click",function(){t.add(111,1)}),$("#buy2").on("click",function(){t.add(222,1)}),$("#buy3").on("click",function(){t.add(333,1)}),$("#buy4").on("click",function(){t.add(444,1)}),$("#cancel1").on("click",function(){t.delete(111,1)}),$("#cancel2").on("click",function(){t.delete(222,1)}),$("#cancel3").on("click",function(){t.delete(333,1)}),$("#cancel4").on("click",function(){t.delete(444,1)})});
//# sourceMappingURL=maps/total.js.map
